{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.0", "generated_at": "2024-12-16T07:45:32.505887Z", "invocation_id": "cfbc1db9-66c1-46c2-a94b-8c0cef32314f", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:44:55.525836Z", "completed_at": "2024-12-16T07:44:56.166146Z"}, {"name": "execute", "started_at": "2024-12-16T07:44:56.166739Z", "completed_at": "2024-12-16T07:44:56.166743Z"}], "thread_id": "main", "execution_time": 0.640907, "adapter_response": {}, "message": "elementary.on-run-start.0 passed", "failures": 0, "unique_id": "operation.elementary.elementary-on-run-start-0", "compiled": true, "compiled_code": "\n  \n  \n\n  \n  \n\n  \n    \n  \n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:44:56.213199Z", "completed_at": "2024-12-16T07:44:56.362110Z"}, {"name": "execute", "started_at": "2024-12-16T07:44:56.389522Z", "completed_at": "2024-12-16T07:45:01.324381Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 5.151340961456299, "adapter_response": {"_message": "MERGE (0.0 rows, 215.0 Bytes processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 215, "bytes_billed": 20971520, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "bb0f14b1-1b9c-488d-af58-da3b39f10798", "slot_ms": 4157}, "message": "MERGE (0.0 rows, 215.0 Bytes processed)", "failures": null, "unique_id": "model.elementary.dbt_invocations", "compiled": true, "compiled_code": "\n\nselect * from (\n            select\n            \n                \n        cast('this_is_just_a_long_dummy_string' as string) as invocation_id\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as job_id\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as job_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as job_run_id\n\n,\n                \n        cast('dummy_string' as string) as run_started_at\n\n,\n                \n        cast('dummy_string' as string) as run_completed_at\n\n,\n                \n        cast('dummy_string' as string) as generated_at\n\n,\n                cast('2091-02-17' as timestamp) as created_at\n\n,\n                \n        cast('dummy_string' as string) as command\n\n,\n                \n        cast('dummy_string' as string) as dbt_version\n\n,\n                \n        cast('dummy_string' as string) as elementary_version\n\n,\n                \n        cast (True as BOOL) as full_refresh\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as invocation_vars\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as vars\n\n,\n                \n        cast('dummy_string' as string) as target_name\n\n,\n                \n        cast('dummy_string' as string) as target_database\n\n,\n                \n        cast('dummy_string' as string) as target_schema\n\n,\n                \n        cast('dummy_string' as string) as target_profile_name\n\n,\n                \n        cast(123456789 as INT64) as threads\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as selected\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as yaml_selector\n\n,\n                \n        cast('dummy_string' as string) as project_id\n\n,\n                \n        cast('dummy_string' as string) as project_name\n\n,\n                \n        cast('dummy_string' as string) as env\n\n,\n                \n        cast('dummy_string' as string) as env_id\n\n,\n                \n        cast('dummy_string' as string) as cause_category\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as cause\n\n,\n                \n        cast('dummy_string' as string) as pull_request_id\n\n,\n                \n        cast('dummy_string' as string) as git_sha\n\n,\n                \n        cast('dummy_string' as string) as orchestrator\n\n,\n                \n        cast('dummy_string' as string) as dbt_user\n\n,\n                \n        cast('dummy_string' as string) as job_url\n\n,\n                \n        cast('dummy_string' as string) as job_run_url\n\n,\n                \n        cast('dummy_string' as string) as account_id\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as target_adapter_specific_fields\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`dbt_invocations`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:44:56.303913Z", "completed_at": "2024-12-16T07:44:56.381142Z"}, {"name": "execute", "started_at": "2024-12-16T07:44:56.407174Z", "completed_at": "2024-12-16T07:45:01.479301Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 5.296949148178101, "adapter_response": {"_message": "MERGE (0.0 rows, 87.2 KiB processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 89304, "bytes_billed": 20971520, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "08b0ad94-7d89-4f77-b8fc-9e162837cbf1", "slot_ms": 1702}, "message": "MERGE (0.0 rows, 87.2 KiB processed)", "failures": null, "unique_id": "model.elementary.dbt_run_results", "compiled": true, "compiled_code": "\n\nselect * from (\n            select\n            \n                \n        cast('this_is_just_a_long_dummy_string' as string) as model_execution_id\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as unique_id\n\n,\n                \n        cast('dummy_string' as string) as invocation_id\n\n,\n                \n        cast('dummy_string' as string) as generated_at\n\n,\n                cast('2091-02-17' as timestamp) as created_at\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as message\n\n,\n                \n        cast('dummy_string' as string) as status\n\n,\n                \n        cast('dummy_string' as string) as resource_type\n\n,\n                \n        cast(123456789.99 as FLOAT64) as execution_time\n\n,\n                \n        cast('dummy_string' as string) as execute_started_at\n\n,\n                \n        cast('dummy_string' as string) as execute_completed_at\n\n,\n                \n        cast('dummy_string' as string) as compile_started_at\n\n,\n                \n        cast('dummy_string' as string) as compile_completed_at\n\n,\n                \n        cast(31474836478 as bigint) as rows_affected\n\n,\n                \n        cast (True as BOOL) as full_refresh\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as compiled_code\n\n,\n                \n        cast(31474836478 as bigint) as failures\n\n,\n                \n        cast('dummy_string' as string) as query_id\n\n,\n                \n        cast('dummy_string' as string) as thread_id\n\n,\n                \n        cast('dummy_string' as string) as materialization\n\n,\n                \n        cast('dummy_string' as string) as adapter_response\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`dbt_run_results`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:44:56.188048Z", "completed_at": "2024-12-16T07:44:56.297728Z"}, {"name": "execute", "started_at": "2024-12-16T07:44:56.328798Z", "completed_at": "2024-12-16T07:45:02.137012Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 5.982294082641602, "adapter_response": {"_message": "MERGE (0.0 rows, 0 processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "3aab52ac-3ca7-4d41-903a-d260ecddf6db", "slot_ms": 3355}, "message": "MERGE (0.0 rows, 0 processed)", "failures": null, "unique_id": "model.elementary.data_monitoring_metrics", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n    \n    select * from (\n            select\n            \n                \n        cast('dummy_string' as string) as id\n\n,\n                \n        cast('dummy_string' as string) as full_table_name\n\n,\n                \n        cast('dummy_string' as string) as column_name\n\n,\n                \n        cast('dummy_string' as string) as metric_name\n\n,\n                \n        cast(123456789.99 as FLOAT64) as metric_value\n\n,\n                \n        cast('dummy_string' as string) as source_value\n\n,\n                cast('2091-02-17' as timestamp) as bucket_start\n\n,\n                cast('2091-02-17' as timestamp) as bucket_end\n\n,\n                \n        cast(123456789 as INT64) as bucket_duration_hours\n\n,\n                cast('2091-02-17' as timestamp) as updated_at\n\n,\n                \n        cast('dummy_string' as string) as dimension\n\n,\n                \n        cast('dummy_string' as string) as dimension_value\n\n,\n                \n        cast('dummy_string' as string) as metric_properties\n\n,\n                cast('2091-02-17' as timestamp) as created_at\n\n\n        ) as empty_table\n        where 1 = 0\n", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`data_monitoring_metrics`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:44:56.320661Z", "completed_at": "2024-12-16T07:44:56.389035Z"}, {"name": "execute", "started_at": "2024-12-16T07:44:56.411448Z", "completed_at": "2024-12-16T07:45:02.686052Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 6.503186941146851, "adapter_response": {"_message": "MERGE (0.0 rows, 0 processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "0208876a-0f04-458f-9760-5b190bfcc82d", "slot_ms": 3013}, "message": "MERGE (0.0 rows, 0 processed)", "failures": null, "unique_id": "model.elementary.dbt_source_freshness_results", "compiled": true, "compiled_code": "\n\n\n    select * from (\n            select\n            \n                \n        cast('dummy_string' as string) as source_freshness_execution_id\n\n,\n                \n        cast('dummy_string' as string) as unique_id\n\n,\n                \n        cast('dummy_string' as string) as max_loaded_at\n\n,\n                \n        cast('dummy_string' as string) as snapshotted_at\n\n,\n                \n        cast('dummy_string' as string) as generated_at\n\n,\n                cast('2091-02-17' as timestamp) as created_at\n\n,\n                \n        cast(123456789.99 as FLOAT64) as max_loaded_at_time_ago_in_s\n\n,\n                \n        cast('dummy_string' as string) as status\n\n,\n                \n        cast('dummy_string' as string) as error\n\n,\n                \n        cast('dummy_string' as string) as compile_started_at\n\n,\n                \n        cast('dummy_string' as string) as compile_completed_at\n\n,\n                \n        cast('dummy_string' as string) as execute_started_at\n\n,\n                \n        cast('dummy_string' as string) as execute_completed_at\n\n,\n                \n        cast('dummy_string' as string) as invocation_id\n\n,\n                \n        cast('dummy_string' as string) as warn_after\n\n,\n                \n        cast('dummy_string' as string) as error_after\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as filter\n\n\n        ) as empty_table\n        where 1 = 0\n", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`dbt_source_freshness_results`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:02.699009Z", "completed_at": "2024-12-16T07:45:02.710200Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:02.710630Z", "completed_at": "2024-12-16T07:45:04.745125Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 2.0939807891845703, "adapter_response": {"_message": "CREATE TABLE (1.0 rows, 0 processed)", "code": "CREATE TABLE", "rows_affected": 1, "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "85cb76f7-0bd6-4398-8bdf-39ef1f9b8cc1", "slot_ms": 150}, "message": "CREATE TABLE (1.0 rows, 0 processed)", "failures": null, "unique_id": "model.elementary.metadata", "compiled": true, "compiled_code": "\n\nSELECT\n    '0.13.2' as dbt_pkg_version", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`metadata`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:44:56.314609Z", "completed_at": "2024-12-16T07:44:56.380404Z"}, {"name": "execute", "started_at": "2024-12-16T07:44:56.398537Z", "completed_at": "2024-12-16T07:45:06.085377Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 9.918492794036865, "adapter_response": {"_message": "MERGE (0.0 rows, 0 processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "ec2d8bac-339a-4a97-9bc6-968cbda22399", "slot_ms": 3554}, "message": "MERGE (0.0 rows, 0 processed)", "failures": null, "unique_id": "model.elementary.dbt_snapshots", "compiled": true, "compiled_code": "\n\nselect * from (\n            select\n            \n                \n        cast('dummy_string' as string) as unique_id\n\n,\n                \n        cast('dummy_string' as string) as alias\n\n,\n                \n        cast('dummy_string' as string) as checksum\n\n,\n                \n        cast('dummy_string' as string) as materialization\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as tags\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as meta\n\n,\n                \n        cast('dummy_string' as string) as owner\n\n,\n                \n        cast('dummy_string' as string) as database_name\n\n,\n                \n        cast('dummy_string' as string) as schema_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as depends_on_macros\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as depends_on_nodes\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as description\n\n,\n                \n        cast('dummy_string' as string) as name\n\n,\n                \n        cast('dummy_string' as string) as package_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as original_path\n\n,\n                \n        cast('dummy_string' as string) as path\n\n,\n                \n        cast('dummy_string' as string) as patch_path\n\n,\n                \n        cast('dummy_string' as string) as generated_at\n\n,\n                \n        cast('dummy_string' as string) as metadata_hash\n\n,\n                \n        cast('dummy_string' as string) as bigquery_partition_by\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`dbt_snapshots`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:44:56.206115Z", "completed_at": "2024-12-16T07:44:56.342793Z"}, {"name": "execute", "started_at": "2024-12-16T07:44:56.381451Z", "completed_at": "2024-12-16T07:45:06.615379Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 10.434418201446533, "adapter_response": {"_message": "MERGE (0.0 rows, 0 processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "51587ed3-3263-4e2e-b527-ab722eec0ec6", "slot_ms": 4930}, "message": "MERGE (0.0 rows, 0 processed)", "failures": null, "unique_id": "model.elementary.dbt_exposures", "compiled": true, "compiled_code": "\n\nselect * from (\n            select\n            \n                \n        cast('dummy_string' as string) as unique_id\n\n,\n                \n        cast('dummy_string' as string) as name\n\n,\n                \n        cast('dummy_string' as string) as maturity\n\n,\n                \n        cast('dummy_string' as string) as type\n\n,\n                \n        cast('dummy_string' as string) as owner_email\n\n,\n                \n        cast('dummy_string' as string) as owner_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as url\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as depends_on_macros\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as depends_on_nodes\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as depends_on_columns\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as description\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as tags\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as meta\n\n,\n                \n        cast('dummy_string' as string) as package_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as original_path\n\n,\n                \n        cast('dummy_string' as string) as path\n\n,\n                \n        cast('dummy_string' as string) as generated_at\n\n,\n                \n        cast('dummy_string' as string) as metadata_hash\n\n,\n                \n        cast('dummy_string' as string) as label\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as raw_queries\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`dbt_exposures`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:44:56.292171Z", "completed_at": "2024-12-16T07:44:56.355162Z"}, {"name": "execute", "started_at": "2024-12-16T07:44:56.385815Z", "completed_at": "2024-12-16T07:45:06.802046Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 10.620841979980469, "adapter_response": {"_message": "MERGE (0.0 rows, 0 processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "527272d9-70ce-4009-9023-6b141e8c4060", "slot_ms": 4636}, "message": "MERGE (0.0 rows, 0 processed)", "failures": null, "unique_id": "model.elementary.dbt_metrics", "compiled": true, "compiled_code": "\n\nselect * from (\n            select\n            \n                \n        cast('dummy_string' as string) as unique_id\n\n,\n                \n        cast('dummy_string' as string) as name\n\n,\n                \n        cast('dummy_string' as string) as label\n\n,\n                \n        cast('dummy_string' as string) as model\n\n,\n                \n        cast('dummy_string' as string) as type\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as sql\n\n,\n                \n        cast('dummy_string' as string) as timestamp\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as filters\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as time_grains\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as dimensions\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as depends_on_macros\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as depends_on_nodes\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as description\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as tags\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as meta\n\n,\n                \n        cast('dummy_string' as string) as package_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as original_path\n\n,\n                \n        cast('dummy_string' as string) as path\n\n,\n                \n        cast('dummy_string' as string) as generated_at\n\n,\n                \n        cast('dummy_string' as string) as metadata_hash\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`dbt_metrics`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:02.202508Z", "completed_at": "2024-12-16T07:45:02.222500Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:02.222828Z", "completed_at": "2024-12-16T07:45:06.979208Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.778064012527466, "adapter_response": {"_message": "MERGE (0.0 rows, 16.8 KiB processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 17191, "bytes_billed": 20971520, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "3e1baab3-869f-4d17-a014-65f2ccbd9408", "slot_ms": 1831}, "message": "MERGE (0.0 rows, 16.8 KiB processed)", "failures": null, "unique_id": "model.elementary.elementary_test_results", "compiled": true, "compiled_code": "\n\n\n    select * from (\n            select\n            \n                \n        cast('this_is_just_a_long_dummy_string' as string) as id\n\n,\n                \n        cast('dummy_string' as string) as data_issue_id\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as test_execution_id\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as test_unique_id\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as model_unique_id\n\n,\n                \n        cast('dummy_string' as string) as invocation_id\n\n,\n                cast('2091-02-17' as timestamp) as detected_at\n\n,\n                cast('2091-02-17' as timestamp) as created_at\n\n,\n                \n        cast('dummy_string' as string) as database_name\n\n,\n                \n        cast('dummy_string' as string) as schema_name\n\n,\n                \n        cast('dummy_string' as string) as table_name\n\n,\n                \n        cast('dummy_string' as string) as column_name\n\n,\n                \n        cast('dummy_string' as string) as test_type\n\n,\n                \n        cast('dummy_string' as string) as test_sub_type\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as test_results_description\n\n,\n                \n        cast('dummy_string' as string) as owners\n\n,\n                \n        cast('dummy_string' as string) as tags\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as test_results_query\n\n,\n                \n        cast('dummy_string' as string) as other\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as test_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as test_params\n\n,\n                \n        cast('dummy_string' as string) as severity\n\n,\n                \n        cast('dummy_string' as string) as status\n\n,\n                \n        cast(31474836478 as bigint) as failures\n\n,\n                \n        cast('dummy_string' as string) as test_short_name\n\n,\n                \n        cast('dummy_string' as string) as test_alias\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as result_rows\n\n,\n                \n        cast(31474836478 as bigint) as failed_row_count\n\n\n        ) as empty_table\n        where 1 = 0\n", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`elementary_test_results`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:06.983638Z", "completed_at": "2024-12-16T07:45:06.990438Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:06.990789Z", "completed_at": "2024-12-16T07:45:07.707538Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7252869606018066, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "d977ac20-d402-456c-9925-b265a27f0416", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.elementary.job_run_results", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith jobs as (\n  select\n    job_name,\n    job_id,\n    job_run_id,\n    \nmin(cast(run_started_at as timestamp))\n as job_run_started_at,\n    \nmax(cast(run_completed_at as timestamp))\n as job_run_completed_at,\n    \n    timestamp_diff(\nmax(cast(run_completed_at as timestamp))\n, \nmin(cast(run_started_at as timestamp))\n, second)\n as job_run_execution_time\n  from `ubie-yu-sandbox`.`jaffle_shop`.`dbt_invocations`\n  where job_id is not null\n  group by job_name, job_id, job_run_id\n)\n\nselect\n  job_name as name,\n  job_id as id,\n  job_run_id as run_id,\n  job_run_started_at as run_started_at,\n  job_run_completed_at as run_completed_at,\n  job_run_execution_time as run_execution_time\nfrom jobs", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`job_run_results`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:44:56.298165Z", "completed_at": "2024-12-16T07:44:56.369480Z"}, {"name": "execute", "started_at": "2024-12-16T07:44:56.394502Z", "completed_at": "2024-12-16T07:45:07.990005Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 11.8076331615448, "adapter_response": {"_message": "MERGE (0.0 rows, 24.5 KiB processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 25046, "bytes_billed": 20971520, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "c795fe10-d038-43f4-92b8-b1e105821ee3", "slot_ms": 3423}, "message": "MERGE (0.0 rows, 24.5 KiB processed)", "failures": null, "unique_id": "model.elementary.dbt_models", "compiled": true, "compiled_code": "\n\nselect * from (\n            select\n            \n                \n        cast('dummy_string' as string) as unique_id\n\n,\n                \n        cast('dummy_string' as string) as alias\n\n,\n                \n        cast('dummy_string' as string) as checksum\n\n,\n                \n        cast('dummy_string' as string) as materialization\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as tags\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as meta\n\n,\n                \n        cast('dummy_string' as string) as owner\n\n,\n                \n        cast('dummy_string' as string) as database_name\n\n,\n                \n        cast('dummy_string' as string) as schema_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as depends_on_macros\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as depends_on_nodes\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as description\n\n,\n                \n        cast('dummy_string' as string) as name\n\n,\n                \n        cast('dummy_string' as string) as package_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as original_path\n\n,\n                \n        cast('dummy_string' as string) as path\n\n,\n                \n        cast('dummy_string' as string) as patch_path\n\n,\n                \n        cast('dummy_string' as string) as generated_at\n\n,\n                \n        cast('dummy_string' as string) as metadata_hash\n\n,\n                \n        cast('dummy_string' as string) as bigquery_partition_by\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`dbt_models`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:07.714794Z", "completed_at": "2024-12-16T07:45:07.725802Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:07.726289Z", "completed_at": "2024-12-16T07:45:08.310959Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5989539623260498, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "8ca788a8-f307-4880-80f1-9dce03626af7", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.elementary.metrics_anomaly_score", "compiled": true, "compiled_code": "\n\nwith data_monitoring_metrics as (\n\n    select * from `ubie-yu-sandbox`.`jaffle_shop`.`data_monitoring_metrics`\n\n),\n\ntime_window_aggregation as (\n\n    select\n        id,\n        full_table_name,\n        column_name,\n        dimension,\n        dimension_value,\n        metric_name,\n        metric_value,\n        source_value,\n        bucket_start,\n        bucket_end,\n        bucket_duration_hours,\n        updated_at,\n        avg(metric_value) over (partition by metric_name, full_table_name, column_name order by bucket_start asc rows between unbounded preceding and current row) as training_avg,\n        stddev(metric_value) over (partition by metric_name, full_table_name, column_name order by bucket_start asc rows between unbounded preceding and current row) as training_stddev,\n        count(metric_value) over (partition by metric_name, full_table_name, column_name order by bucket_start asc rows between unbounded preceding and current row) as training_set_size,\n        last_value(bucket_end) over (partition by metric_name, full_table_name, column_name order by bucket_start asc rows between unbounded preceding and current row) training_end,\n        first_value(bucket_end) over (partition by metric_name, full_table_name, column_name order by bucket_start asc rows between unbounded preceding and current row) as training_start\n    from data_monitoring_metrics\n    group by 1,2,3,4,5,6,7,8,9,10,11,12\n),\n\nmetrics_anomaly_score as (\n\n    select\n        id,\n        full_table_name,\n        column_name,\n        dimension,\n        dimension_value,\n        metric_name,\n        case\n            when training_stddev is null then null\n            when training_stddev = 0 then 0\n            else (metric_value - training_avg) / (training_stddev)\n        end as anomaly_score,\n        metric_value as latest_metric_value,\n        bucket_start,\n        bucket_end,\n        training_avg,\n        training_stddev,\n        training_start,\n        training_end,\n        training_set_size,\n        max(updated_at) as updated_at\n    from time_window_aggregation\n        where\n            metric_value is not null\n            and training_avg is not null\n            and bucket_end >= \n       timestamp_add(cast(\n    timestamp_trunc(cast(current_timestamp as timestamp), day)\n as timestamp), INTERVAL cast(-7 as INT64) day)\n\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15\n    order by bucket_end desc\n\n\n),\n\nfinal as (\n\n    select\n        id,\n        full_table_name,\n        column_name,\n        dimension,\n        dimension_value,\n        metric_name,\n        anomaly_score,\n        latest_metric_value,\n        bucket_start,\n        bucket_end,\n        training_avg,\n        training_stddev,\n        training_start,\n        training_end,\n        training_set_size,\n        updated_at,\n        case\n            when abs(anomaly_score) > 3 then true\n            else false end\n        as is_anomaly\n    from metrics_anomaly_score\n)\n\nselect * from final", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`metrics_anomaly_score`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:07.996636Z", "completed_at": "2024-12-16T07:45:08.002060Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:08.002883Z", "completed_at": "2024-12-16T07:45:08.524761Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5313479900360107, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "93638734-269b-4668-8761-a33171955486", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.elementary.monitors_runs", "compiled": true, "compiled_code": "\n\nwith data_monitoring_metrics as (\n\n    select * from `ubie-yu-sandbox`.`jaffle_shop`.`data_monitoring_metrics`\n\n),\n\nmax_bucket_end as (\n\n    select full_table_name,\n           column_name,\n           metric_name,\n           metric_properties,\n           max(bucket_end) as last_bucket_end,\n           min(bucket_end) as first_bucket_end\n    from data_monitoring_metrics\n    group by 1,2,3,4\n\n)\n\nselect * from max_bucket_end", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`monitors_runs`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:08.314110Z", "completed_at": "2024-12-16T07:45:08.317720Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:08.317973Z", "completed_at": "2024-12-16T07:45:08.973889Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6636397838592529, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "8740a882-6214-418f-9361-465a3ac2631a", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.elementary.snapshot_run_results", "compiled": true, "compiled_code": "\n\nwith dbt_run_results as (\n    select * from `ubie-yu-sandbox`.`jaffle_shop`.`dbt_run_results`\n),\n\ndbt_snapshots as (\n    select * from `ubie-yu-sandbox`.`jaffle_shop`.`dbt_snapshots`\n)\n\nSELECT\n    run_results.model_execution_id,\n    run_results.unique_id,\n    run_results.invocation_id,\n    run_results.query_id,\n    run_results.name,\n    run_results.generated_at,\n    run_results.status,\n    run_results.full_refresh,\n    run_results.message,\n    run_results.execution_time,\n    run_results.execute_started_at,\n    run_results.execute_completed_at,\n    run_results.compile_started_at,\n    run_results.compile_completed_at,\n    run_results.compiled_code,\n    run_results.adapter_response,\n    run_results.thread_id,\n    snapshots.database_name,\n    snapshots.schema_name,\n    coalesce(run_results.materialization, snapshots.materialization) as materialization,\n    snapshots.tags,\n    snapshots.package_name,\n    snapshots.path,\n    snapshots.original_path,\n    snapshots.owner,\n    snapshots.alias\nFROM dbt_run_results run_results\nJOIN dbt_snapshots snapshots ON run_results.unique_id = snapshots.unique_id", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`snapshot_run_results`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:08.537902Z", "completed_at": "2024-12-16T07:45:08.550345Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:08.550986Z", "completed_at": "2024-12-16T07:45:09.145506Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.610023021697998, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "1b68923b-17ad-4906-8465-db004cd03b55", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.elementary.alerts_anomaly_detection", "compiled": true, "compiled_code": "\n\nwith elementary_test_results as (\n    select * from `ubie-yu-sandbox`.`jaffle_shop`.`elementary_test_results`\n),\n\nalerts_anomaly_detection as (\n    select id as alert_id,\n           data_issue_id,\n           test_execution_id,\n           test_unique_id,\n           model_unique_id,\n           detected_at,\n           database_name,\n           schema_name,\n           table_name,\n           column_name,\n           test_type as alert_type,\n           test_sub_type as sub_type,\n           test_results_description as alert_description,\n           owners,\n           tags,\n           test_results_query as alert_results_query,\n           other,\n           test_name,\n           test_short_name,\n           test_params,\n           severity,\n           status,\n           result_rows\n        from elementary_test_results\n        where True and lower(status) != 'pass'and lower(status) != 'skipped'and test_type = 'anomaly_detection'\n)\n\nselect * from alerts_anomaly_detection", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`alerts_anomaly_detection`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:44:56.309666Z", "completed_at": "2024-12-16T07:44:56.380740Z"}, {"name": "execute", "started_at": "2024-12-16T07:44:56.402431Z", "completed_at": "2024-12-16T07:45:09.470853Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 13.28734302520752, "adapter_response": {"_message": "MERGE (0.0 rows, 832.0 Bytes processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 832, "bytes_billed": 20971520, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "e9a07748-fea0-4ba3-bd4e-80735032efaa", "slot_ms": 2174}, "message": "MERGE (0.0 rows, 832.0 Bytes processed)", "failures": null, "unique_id": "model.elementary.dbt_seeds", "compiled": true, "compiled_code": "\n\nselect * from (\n            select\n            \n                \n        cast('dummy_string' as string) as unique_id\n\n,\n                \n        cast('dummy_string' as string) as alias\n\n,\n                \n        cast('dummy_string' as string) as checksum\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as tags\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as meta\n\n,\n                \n        cast('dummy_string' as string) as owner\n\n,\n                \n        cast('dummy_string' as string) as database_name\n\n,\n                \n        cast('dummy_string' as string) as schema_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as description\n\n,\n                \n        cast('dummy_string' as string) as name\n\n,\n                \n        cast('dummy_string' as string) as package_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as original_path\n\n,\n                \n        cast('dummy_string' as string) as path\n\n,\n                \n        cast('dummy_string' as string) as generated_at\n\n,\n                \n        cast('dummy_string' as string) as metadata_hash\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`dbt_seeds`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:08.981804Z", "completed_at": "2024-12-16T07:45:08.989307Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:08.989713Z", "completed_at": "2024-12-16T07:45:09.565167Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.58544921875, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "f5a83c06-133b-486e-b5fc-ae4969479da4", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.elementary.alerts_dbt_tests", "compiled": true, "compiled_code": "\n\nwith elementary_test_results as (\n    select * from `ubie-yu-sandbox`.`jaffle_shop`.`elementary_test_results`\n),\n\nalerts_dbt_tests as (\n    select id as alert_id,\n           data_issue_id,\n           test_execution_id,\n           test_unique_id,\n           model_unique_id,\n           detected_at,\n           database_name,\n           schema_name,\n           table_name,\n           column_name,\n           test_type as alert_type,\n           test_sub_type as sub_type,\n           test_results_description as alert_description,\n           owners,\n           tags,\n           test_results_query as alert_results_query,\n           other,\n           test_name,\n           test_short_name,\n           test_params,\n           severity,\n           status,\n           result_rows\n        from elementary_test_results\n        where True and lower(status) != 'pass'   and lower(status) != 'skipped'  and test_type = 'dbt_test'\n)\n\nselect * from alerts_dbt_tests", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`alerts_dbt_tests`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:04.808480Z", "completed_at": "2024-12-16T07:45:04.833095Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:04.833516Z", "completed_at": "2024-12-16T07:45:09.737989Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 4.930409908294678, "adapter_response": {"_message": "MERGE (0.0 rows, 0 processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "8a4e8a0e-f248-43bc-8176-cd1934e2e7ca", "slot_ms": 3108}, "message": "MERGE (0.0 rows, 0 processed)", "failures": null, "unique_id": "model.elementary.schema_columns_snapshot", "compiled": true, "compiled_code": "\n\n\n    select * from (\n            select\n            \n                \n        cast('dummy_string' as string) as column_state_id\n\n,\n                \n        cast('dummy_string' as string) as full_column_name\n\n,\n                \n        cast('dummy_string' as string) as full_table_name\n\n,\n                \n        cast('dummy_string' as string) as column_name\n\n,\n                \n        cast('dummy_string' as string) as data_type\n\n,\n                \n        cast (True as BOOL) as is_new\n\n,\n                cast('2091-02-17' as timestamp) as detected_at\n\n,\n                cast('2091-02-17' as timestamp) as created_at\n\n\n        ) as empty_table\n        where 1 = 0\n", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`schema_columns_snapshot`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:06.618131Z", "completed_at": "2024-12-16T07:45:06.618132Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:06.618433Z", "completed_at": "2024-12-16T07:45:09.773523Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.156231164932251, "adapter_response": {"_message": "INSERT 99", "code": "INSERT", "rows_affected": 99}, "message": "INSERT 99", "failures": null, "unique_id": "seed.jaffle_shop.raw_orders", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:09.150333Z", "completed_at": "2024-12-16T07:45:09.277402Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:09.278324Z", "completed_at": "2024-12-16T07:45:09.962792Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.8134353160858154, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "06570e04-0045-46da-b600-40a0790e99dc", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.elementary.alerts_schema_changes", "compiled": true, "compiled_code": "\n\n\nwith elementary_test_results as (\n    select * from `ubie-yu-sandbox`.`jaffle_shop`.`elementary_test_results`\n),\n\nalerts_schema_changes as (\n    select id as alert_id,\n           data_issue_id,\n           test_execution_id,\n           test_unique_id,\n           model_unique_id,\n           detected_at,\n           database_name,\n           schema_name,\n           table_name,\n           column_name,\n           test_type as alert_type,\n           test_sub_type as sub_type,\n           test_results_description as alert_description,\n           owners,\n           tags,\n           test_results_query as alert_results_query,\n           other,\n           test_name,\n           test_short_name,\n           test_params,\n           severity,\n           status,\n           result_rows\n        from elementary_test_results\n        where True and lower(status) != 'pass'and lower(status) != 'skipped'and test_type = 'schema_change'\n)\n\nselect * from alerts_schema_changes", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`alerts_schema_changes`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:09.571488Z", "completed_at": "2024-12-16T07:45:09.579643Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:09.580819Z", "completed_at": "2024-12-16T07:45:10.130590Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5606799125671387, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "cf71b0d4-4bd4-44f3-8df1-c19ddf11f349", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.elementary.model_run_results", "compiled": true, "compiled_code": "\n\nwith dbt_run_results as (\n    select * from `ubie-yu-sandbox`.`jaffle_shop`.`dbt_run_results`\n),\n\ndbt_models as (\n    select * from `ubie-yu-sandbox`.`jaffle_shop`.`dbt_models`\n)\n\nSELECT\n    run_results.model_execution_id,\n    run_results.unique_id,\n    run_results.invocation_id,\n    run_results.query_id,\n    run_results.name,\n    run_results.generated_at,\n    run_results.status,\n    run_results.full_refresh,\n    run_results.message,\n    run_results.execution_time,\n    run_results.execute_started_at,\n    run_results.execute_completed_at,\n    run_results.compile_started_at,\n    run_results.compile_completed_at,\n    run_results.compiled_code,\n    run_results.adapter_response,\n    run_results.thread_id,\n    models.database_name,\n    models.schema_name,\n    coalesce(run_results.materialization, models.materialization) as materialization,\n    models.tags,\n    models.package_name,\n    models.path,\n    models.original_path,\n    models.owner,\n    models.alias,\n    ROW_NUMBER() OVER (PARTITION BY run_results.unique_id ORDER BY run_results.generated_at DESC) AS model_invocation_reverse_index,\n    CASE WHEN FIRST_VALUE(invocation_id) OVER (PARTITION BY \n    timestamp_trunc(cast(run_results.generated_at as timestamp), day)\n ORDER BY run_results.generated_at ASC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING ) = invocation_id\n              THEN TRUE\n              ELSE FALSE \n         END                                                               AS is_the_first_invocation_of_the_day,\n    CASE WHEN LAST_VALUE(invocation_id) OVER (PARTITION BY \n    timestamp_trunc(cast(run_results.generated_at as timestamp), day)\n ORDER BY run_results.generated_at ASC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING ) = invocation_id\n              THEN TRUE\n              ELSE FALSE \n         END                                                               AS is_the_last_invocation_of_the_day\n    \nFROM dbt_run_results run_results\nJOIN dbt_models models ON run_results.unique_id = models.unique_id", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`model_run_results`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:06.133171Z", "completed_at": "2024-12-16T07:45:06.133174Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:06.133653Z", "completed_at": "2024-12-16T07:45:10.354748Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 4.2235426902771, "adapter_response": {"_message": "INSERT 100", "code": "INSERT", "rows_affected": 100}, "message": "INSERT 100", "failures": null, "unique_id": "seed.jaffle_shop.raw_customers", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:01.432374Z", "completed_at": "2024-12-16T07:45:01.460112Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:01.482429Z", "completed_at": "2024-12-16T07:45:10.367826Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 8.955688238143921, "adapter_response": {"_message": "MERGE (0.0 rows, 0 processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "732e896a-99b5-43db-8e99-d082ab69a906", "slot_ms": 1849}, "message": "MERGE (0.0 rows, 0 processed)", "failures": null, "unique_id": "model.elementary.dbt_sources", "compiled": true, "compiled_code": "\n\nselect * from (\n            select\n            \n                \n        cast('dummy_string' as string) as unique_id\n\n,\n                \n        cast('dummy_string' as string) as database_name\n\n,\n                \n        cast('dummy_string' as string) as schema_name\n\n,\n                \n        cast('dummy_string' as string) as source_name\n\n,\n                \n        cast('dummy_string' as string) as name\n\n,\n                \n        cast('dummy_string' as string) as identifier\n\n,\n                \n        cast('dummy_string' as string) as loaded_at_field\n\n,\n                \n        cast('dummy_string' as string) as freshness_warn_after\n\n,\n                \n        cast('dummy_string' as string) as freshness_error_after\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as freshness_filter\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as freshness_description\n\n,\n                \n        cast('dummy_string' as string) as relation_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as tags\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as meta\n\n,\n                \n        cast('dummy_string' as string) as owner\n\n,\n                \n        cast('dummy_string' as string) as package_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as original_path\n\n,\n                \n        cast('dummy_string' as string) as path\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as source_description\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as description\n\n,\n                \n        cast('dummy_string' as string) as generated_at\n\n,\n                \n        cast('dummy_string' as string) as metadata_hash\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`dbt_sources`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:09.783741Z", "completed_at": "2024-12-16T07:45:09.790473Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:09.790948Z", "completed_at": "2024-12-16T07:45:10.413591Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.6325318813323975, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "1b199917-28fa-4436-ad78-b8d01aa78b4f", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.jaffle_shop.stg_orders", "compiled": true, "compiled_code": "with source as (\n    select * from `ubie-yu-sandbox`.`jaffle_shop`.`raw_orders`\n\n),\n\nrenamed as (\n\n    select\n        id as order_id,\n        user_id as customer_id,\n        order_date,\n        status\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`stg_orders`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:09.744564Z", "completed_at": "2024-12-16T07:45:09.763102Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:09.764580Z", "completed_at": "2024-12-16T07:45:10.545584Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.8031351566314697, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "4825e532-3019-4417-bc75-64b304316b2f", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.elementary.anomaly_threshold_sensitivity", "compiled": true, "compiled_code": "\n\nwith metrics_anomaly_score as (\n\n    select * from `ubie-yu-sandbox`.`jaffle_shop`.`metrics_anomaly_score`\n\n),\n\nscore_sensitivity as (\n\n    select\n        full_table_name,\n        column_name,\n        metric_name,\n        latest_metric_value,\n        training_avg as metric_avg,\n        training_stddev as metric_stddev,\n        anomaly_score,\n        case when abs(anomaly_score) >= 1.5 then true else false end as `is_anomaly_1_5`,\n        case when abs(anomaly_score) >= 2 then true else false end as `is_anomaly_2`,\n        case when abs(anomaly_score) >= 2.5 then true else false end as `is_anomaly_2_5`,\n        case when abs(anomaly_score) >= 3 then true else false end as `is_anomaly_3`,\n        case when abs(anomaly_score) >= 3.5 then true else false end as `is_anomaly_3_5`,\n        case when abs(anomaly_score) >= 4 then true else false end as `is_anomaly_4`,\n        case when abs(anomaly_score) >= 4.5 then true else false end as `is_anomaly_4_5`\n    from metrics_anomaly_score\n    where abs(anomaly_score) >= 1.5\n\n)\n\nselect * from score_sensitivity", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`anomaly_threshold_sensitivity`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:06.816035Z", "completed_at": "2024-12-16T07:45:06.816037Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:06.816357Z", "completed_at": "2024-12-16T07:45:10.670307Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 3.855755090713501, "adapter_response": {"_message": "INSERT 113", "code": "INSERT", "rows_affected": 113}, "message": "INSERT 113", "failures": null, "unique_id": "seed.jaffle_shop.raw_payments", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:10.357441Z", "completed_at": "2024-12-16T07:45:10.360445Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:10.360686Z", "completed_at": "2024-12-16T07:45:10.912662Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5560071468353271, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "73887dba-7c0e-4336-9ede-d9015b9e7990", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.jaffle_shop.stg_customers", "compiled": true, "compiled_code": "with source as (\n    select * from `ubie-yu-sandbox`.`jaffle_shop`.`raw_customers`\n\n),\n\nrenamed as (\n\n    select\n        id as customer_id,\n        first_name,\n        last_name\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`stg_customers`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:10.134057Z", "completed_at": "2024-12-16T07:45:10.143908Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:10.144356Z", "completed_at": "2024-12-16T07:45:10.997097Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.8641941547393799, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "e27657a7-ab36-413d-bea1-834c8ad6461f", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.elementary.alerts_dbt_models", "compiled": true, "compiled_code": "\n\nwith error_models as (\n  \n    select  model_execution_id,\n            unique_id,\n            invocation_id,\n            name,\n            generated_at,\n            status,\n            full_refresh,\n            message,\n            execution_time,\n            execute_started_at,\n            execute_completed_at,\n            compile_started_at,\n            compile_completed_at,\n            compiled_code,\n            database_name,\n            schema_name,\n            materialization,\n            tags,\n            package_name,\n            path,\n            original_path,\n            owner,\n            alias \n    from `ubie-yu-sandbox`.`jaffle_shop`.`model_run_results`\n  \n    union all\n  \n    select  model_execution_id,\n            unique_id,\n            invocation_id,\n            name,\n            generated_at,\n            status,\n            full_refresh,\n            message,\n            execution_time,\n            execute_started_at,\n            execute_completed_at,\n            compile_started_at,\n            compile_completed_at,\n            compiled_code,\n            database_name,\n            schema_name,\n            materialization,\n            tags,\n            package_name,\n            path,\n            original_path,\n            owner,\n            alias  \n  from `ubie-yu-sandbox`.`jaffle_shop`.`snapshot_run_results`\n)\n\n\nselect model_execution_id as alert_id,\n       unique_id,\n       cast(generated_at as timestamp) as detected_at,\n       database_name,\n       materialization,\n       path,\n       original_path,\n       schema_name,\n       message,\n       owner as owners,\n       tags,\n       alias,\n       status,\n       full_refresh\nfrom error_models\nwhere True and lower(status) != 'success'and lower(status) != 'skipped'", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`alerts_dbt_models`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:44:56.197438Z", "completed_at": "2024-12-16T07:44:56.320074Z"}, {"name": "execute", "started_at": "2024-12-16T07:44:56.376828Z", "completed_at": "2024-12-16T07:45:11.497984Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 15.319193840026855, "adapter_response": {"_message": "MERGE (0.0 rows, 46.9 KiB processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 48042, "bytes_billed": 20971520, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "a2b69124-db89-4d83-a89c-c7c864999d7b", "slot_ms": 3861}, "message": "MERGE (0.0 rows, 46.9 KiB processed)", "failures": null, "unique_id": "model.elementary.dbt_columns", "compiled": true, "compiled_code": "\n\nselect * from (\n            select\n            \n                \n        cast('dummy_string' as string) as unique_id\n\n,\n                \n        cast('dummy_string' as string) as parent_unique_id\n\n,\n                \n        cast('dummy_string' as string) as name\n\n,\n                \n        cast('dummy_string' as string) as data_type\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as tags\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as meta\n\n,\n                \n        cast('dummy_string' as string) as database_name\n\n,\n                \n        cast('dummy_string' as string) as schema_name\n\n,\n                \n        cast('dummy_string' as string) as table_name\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as description\n\n,\n                \n        cast('dummy_string' as string) as resource_type\n\n,\n                \n        cast('dummy_string' as string) as generated_at\n\n,\n                \n        cast('dummy_string' as string) as metadata_hash\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`dbt_columns`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:11.512406Z", "completed_at": "2024-12-16T07:45:11.529579Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:11.530374Z", "completed_at": "2024-12-16T07:45:12.184401Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7060320377349854, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "2b12141b-747a-42e3-9fe4-b68de0b4691f", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.jaffle_shop.stg_payments", "compiled": true, "compiled_code": "with source as (\n    select * from `ubie-yu-sandbox`.`jaffle_shop`.`raw_payments`\n\n),\n\nrenamed as (\n\n    select\n        id as payment_id,\n        order_id,\n        payment_method,\n\n        -- `amount` is currently stored in cents, so we convert it to dollars\n        amount / 100 as amount\n\n    from source\n\n)\n\nselect * from renamed", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`stg_payments`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:11.479905Z", "completed_at": "2024-12-16T07:45:11.517039Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:11.590931Z", "completed_at": "2024-12-16T07:45:12.285654Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.8243701457977295, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "e85d55df-0b9c-4ce2-af84-0c218c5d0ca7", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.elementary.alerts_dbt_source_freshness", "compiled": true, "compiled_code": "\n\nwith results as (\n  select * from `ubie-yu-sandbox`.`jaffle_shop`.`dbt_source_freshness_results`\n),\n\nsources as (\n  select * from `ubie-yu-sandbox`.`jaffle_shop`.`dbt_sources`\n)\n\nselect\n  results.source_freshness_execution_id as alert_id,\n  results.max_loaded_at,\n  results.snapshotted_at,\n  cast(results.generated_at as timestamp) as detected_at,\n  results.max_loaded_at_time_ago_in_s,\n  results.status,\n  results.error,\n  results.warn_after,\n  results.error_after,\n  results.filter,\n  sources.unique_id,\n  sources.database_name,\n  sources.schema_name,\n  sources.source_name,\n  sources.identifier,\n  sources.tags,\n  sources.meta,\n  sources.owner,\n  sources.package_name,\n  sources.path,\n  -- These columns below are deprecated. We add them since this view\n  -- was used to be loaded into an incremental model with those columns, their names were later changed\n  -- and Databricks doesn't respect `on_schema_change = 'append_new_columns'` properly, as described here -\n  -- https://docs.databricks.com/en/delta/update-schema.html#automatic-schema-evolution-for-delta-lake-merge\n  results.error_after as freshness_error_after,\n  results.warn_after as freshness_warn_after,\n  results.filter as freshness_filter\nfrom results\njoin sources on results.unique_id = sources.unique_id\nwhere True and lower(status) != 'pass'", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`alerts_dbt_source_freshness`", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:11.518721Z", "completed_at": "2024-12-16T07:45:11.565282Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:11.598807Z", "completed_at": "2024-12-16T07:45:12.614533Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 1.1166129112243652, "adapter_response": {"_message": "SELECT (1.0 rows, 792.0 Bytes processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 792, "bytes_billed": 10485760, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "829418f6-18b9-479a-aeb9-374ce2b8d2e5", "slot_ms": 29}, "message": null, "failures": 0, "unique_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom `ubie-yu-sandbox`.`jaffle_shop`.`stg_orders`\nwhere order_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:11.488160Z", "completed_at": "2024-12-16T07:45:11.524456Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:11.566406Z", "completed_at": "2024-12-16T07:45:12.753762Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 1.287905216217041, "adapter_response": {"_message": "SELECT (1.0 rows, 800.0 Bytes processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 800, "bytes_billed": 10485760, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "6a7b3398-2e70-47e9-a2ad-fc83b2b0b09b", "slot_ms": 29}, "message": null, "failures": 0, "unique_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom `ubie-yu-sandbox`.`jaffle_shop`.`stg_customers`\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:11.550378Z", "completed_at": "2024-12-16T07:45:11.596702Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:11.610065Z", "completed_at": "2024-12-16T07:45:12.850028Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 1.3767740726470947, "adapter_response": {"_message": "SELECT (1.0 rows, 792.0 Bytes processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 792, "bytes_billed": 10485760, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "e263d0e7-491c-436e-90be-8aa7e50286d4", "slot_ms": 54}, "message": null, "failures": 0, "unique_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select order_id as unique_field\n  from `ubie-yu-sandbox`.`jaffle_shop`.`stg_orders`\n  where order_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:01.511056Z", "completed_at": "2024-12-16T07:45:02.110552Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:02.138184Z", "completed_at": "2024-12-16T07:45:12.964338Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 11.457621097564697, "adapter_response": {"_message": "MERGE (0.0 rows, 15.7 KiB processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 16057, "bytes_billed": 20971520, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "420b124f-e1d7-4ab7-bf5d-f181206dcf50", "slot_ms": 1561}, "message": "MERGE (0.0 rows, 15.7 KiB processed)", "failures": null, "unique_id": "model.elementary.dbt_tests", "compiled": true, "compiled_code": "\n\nselect * from (\n            select\n            \n                \n        cast('dummy_string' as string) as unique_id\n\n,\n                \n        cast('dummy_string' as string) as database_name\n\n,\n                \n        cast('dummy_string' as string) as schema_name\n\n,\n                \n        cast('dummy_string' as string) as name\n\n,\n                \n        cast('dummy_string' as string) as short_name\n\n,\n                \n        cast('dummy_string' as string) as alias\n\n,\n                \n        cast('dummy_string' as string) as test_column_name\n\n,\n                \n        cast('dummy_string' as string) as severity\n\n,\n                \n        cast('dummy_string' as string) as warn_if\n\n,\n                \n        cast('dummy_string' as string) as error_if\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as test_params\n\n,\n                \n        cast('dummy_string' as string) as test_namespace\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as tags\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as model_tags\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as model_owners\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as meta\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as depends_on_macros\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as depends_on_nodes\n\n,\n                \n        cast('dummy_string' as string) as parent_model_unique_id\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as description\n\n,\n                \n        cast('dummy_string' as string) as package_name\n\n,\n                \n        cast('dummy_string' as string) as type\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as original_path\n\n,\n                \n        cast('dummy_string' as string) as path\n\n,\n                \n        cast('dummy_string' as string) as generated_at\n\n,\n                \n        cast('dummy_string' as string) as metadata_hash\n\n,\n                \n        cast('dummy_string' as string) as quality_dimension\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`dbt_tests`", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:11.645451Z", "completed_at": "2024-12-16T07:45:11.651382Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:11.652219Z", "completed_at": "2024-12-16T07:45:12.992505Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.3623082637786865, "adapter_response": {"_message": "SELECT (1.0 rows, 800.0 Bytes processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 800, "bytes_billed": 10485760, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "81a02f94-4d7a-4fbb-8490-ec98a85c4b26", "slot_ms": 77}, "message": null, "failures": 0, "unique_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select customer_id as unique_field\n  from `ubie-yu-sandbox`.`jaffle_shop`.`stg_customers`\n  where customer_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:11.503382Z", "completed_at": "2024-12-16T07:45:11.527443Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:11.585647Z", "completed_at": "2024-12-16T07:45:13.080098Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.6153178215026855, "adapter_response": {"_message": "SELECT (1.0 rows, 1.0 KiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 1030, "bytes_billed": 10485760, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "dba3cc49-58ed-40d5-8c5e-d1cd05c896ec", "slot_ms": 56}, "message": null, "failures": 0, "unique_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from `ubie-yu-sandbox`.`jaffle_shop`.`stg_orders`\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'placed','shipped','completed','return_pending','returned'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:12.295074Z", "completed_at": "2024-12-16T07:45:12.301456Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:12.301879Z", "completed_at": "2024-12-16T07:45:13.306399Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 1.0122909545898438, "adapter_response": {"_message": "SELECT (1.0 rows, 904.0 Bytes processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 904, "bytes_billed": 10485760, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "319b5475-95dc-47f1-a119-dfca8da98fb2", "slot_ms": 39}, "message": null, "failures": 0, "unique_id": "test.jaffle_shop.not_null_stg_payments_payment_id.c19cc50075", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_id\nfrom `ubie-yu-sandbox`.`jaffle_shop`.`stg_payments`\nwhere payment_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:12.205192Z", "completed_at": "2024-12-16T07:45:12.215371Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:12.215661Z", "completed_at": "2024-12-16T07:45:13.460775Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.2566568851470947, "adapter_response": {"_message": "SELECT (1.0 rows, 1.4 KiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 1446, "bytes_billed": 10485760, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "cd1769d3-dc5a-4006-a1bd-9ea22ce93649", "slot_ms": 63}, "message": null, "failures": 0, "unique_id": "test.jaffle_shop.accepted_values_stg_payments_payment_method__credit_card__coupon__bank_transfer__gift_card.3c3820f278", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        payment_method as value_field,\n        count(*) as n_records\n\n    from `ubie-yu-sandbox`.`jaffle_shop`.`stg_payments`\n    group by payment_method\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'credit_card','coupon','bank_transfer','gift_card'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:12.973330Z", "completed_at": "2024-12-16T07:45:12.982581Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:12.984556Z", "completed_at": "2024-12-16T07:45:13.519201Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5475869178771973, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "9a0dc180-9817-4a1d-a60d-9af85c1eab3b", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.elementary.dbt_artifacts_hashes", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n  'dbt_models' as artifacts_model,\n   metadata_hash\nfrom `ubie-yu-sandbox`.`jaffle_shop`.`dbt_models`\n union all \n\nselect\n  'dbt_tests' as artifacts_model,\n   metadata_hash\nfrom `ubie-yu-sandbox`.`jaffle_shop`.`dbt_tests`\n union all \n\nselect\n  'dbt_sources' as artifacts_model,\n   metadata_hash\nfrom `ubie-yu-sandbox`.`jaffle_shop`.`dbt_sources`\n union all \n\nselect\n  'dbt_snapshots' as artifacts_model,\n   metadata_hash\nfrom `ubie-yu-sandbox`.`jaffle_shop`.`dbt_snapshots`\n union all \n\nselect\n  'dbt_metrics' as artifacts_model,\n   metadata_hash\nfrom `ubie-yu-sandbox`.`jaffle_shop`.`dbt_metrics`\n union all \n\nselect\n  'dbt_exposures' as artifacts_model,\n   metadata_hash\nfrom `ubie-yu-sandbox`.`jaffle_shop`.`dbt_exposures`\n union all \n\nselect\n  'dbt_seeds' as artifacts_model,\n   metadata_hash\nfrom `ubie-yu-sandbox`.`jaffle_shop`.`dbt_seeds`\n union all \n\nselect\n  'dbt_columns' as artifacts_model,\n   metadata_hash\nfrom `ubie-yu-sandbox`.`jaffle_shop`.`dbt_columns`\n\n\norder by metadata_hash", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`dbt_artifacts_hashes`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:11.539800Z", "completed_at": "2024-12-16T07:45:12.943093Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:12.943852Z", "completed_at": "2024-12-16T07:45:13.626745Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 2.1638309955596924, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "0e3f5ec9-c7ba-4489-92a2-aa9b1a369949", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.elementary.information_schema_columns", "compiled": true, "compiled_code": "\n\n    \n  \n    \n  \n\n  with dbt_models_data as (\n      select\n          database_name,\n          schema_name,\n          alias as table_name\n      from `ubie-yu-sandbox`.`jaffle_shop`.`dbt_models`\n  ),\n\n  dbt_snapshots_data as (\n      select\n          database_name,\n          schema_name,\n          alias as table_name\n      from `ubie-yu-sandbox`.`jaffle_shop`.`dbt_snapshots`\n  ),\n\n  dbt_sources_data as (\n      select\n          database_name,\n          schema_name,\n          name as table_name\n      from `ubie-yu-sandbox`.`jaffle_shop`.`dbt_sources`\n  ),\n\n  dbt_seeds_data as (\n      select\n          database_name,\n          schema_name,\n          name as table_name\n      from `ubie-yu-sandbox`.`jaffle_shop`.`dbt_seeds`\n  ),\n\n  tables_information as (\n      select * from dbt_models_data\n      union all\n      select * from dbt_sources_data\n      union all\n      select * from dbt_snapshots_data\n      union all\n      select * from dbt_seeds_data\n  ),\n\n  columns_information as (\n      \n    \n    \n    \n        (\n    \n    \n    \n      \n    \n    \n    select\n        upper(table_catalog || '.' || table_schema || '.' || table_name) as full_table_name,\n        upper(table_catalog) as database_name,\n        upper(table_schema) as schema_name,\n        upper(table_name) as table_name,\n        upper(column_name) as column_name,\n        data_type\n    from `ubie-yu-sandbox`.`jaffle_shop`.INFORMATION_SCHEMA.COLUMNS\n    where upper(table_schema) = upper('jaffle_shop')\n    \n\n    \n)\n        \n    \n\n\n\n  ),\n\n  information_schema_columns as (\n      select col_info.*\n      from tables_information tbl_info\n      join columns_information col_info\n          on (lower(tbl_info.database_name) = lower(col_info.database_name) and\n              lower(tbl_info.schema_name) = lower(col_info.schema_name) and\n              lower(tbl_info.table_name) = lower(col_info.table_name)\n          )\n  )\n\n  select *\n  from information_schema_columns\n\n", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`information_schema_columns`", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:12.627846Z", "completed_at": "2024-12-16T07:45:12.766329Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:12.771419Z", "completed_at": "2024-12-16T07:45:13.776971Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 1.1515467166900635, "adapter_response": {"_message": "SELECT (1.0 rows, 904.0 Bytes processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 904, "bytes_billed": 10485760, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "00b11761-e9ad-4346-9a27-44c4484a160a", "slot_ms": 99}, "message": null, "failures": 0, "unique_id": "test.jaffle_shop.unique_stg_payments_payment_id.3744510712", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select payment_id as unique_field\n  from `ubie-yu-sandbox`.`jaffle_shop`.`stg_payments`\n  where payment_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:13.633792Z", "completed_at": "2024-12-16T07:45:13.638791Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:13.639088Z", "completed_at": "2024-12-16T07:45:14.443412Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.8109879493713379, "adapter_response": {"_message": "CREATE VIEW (0 processed)", "code": "CREATE VIEW", "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "1222d926-c76b-4bbc-b858-c8cb54da933a", "slot_ms": 0}, "message": "CREATE VIEW (0 processed)", "failures": null, "unique_id": "model.elementary.enriched_columns", "compiled": true, "compiled_code": "\n\n\nwith information_schema_columns as (\n    select\n        lower(database_name) as database_name,\n        lower(schema_name) as schema_name,\n        lower(table_name) as table_name,\n        lower(column_name) as name,\n        data_type\n    from `ubie-yu-sandbox`.`jaffle_shop`.`information_schema_columns`\n),\n\ndbt_columns as (\n    select\n        lower(database_name) as database_name,\n        lower(schema_name) as schema_name,\n        lower(table_name) as table_name,\n        lower(name) as name,\n        description\n    from `ubie-yu-sandbox`.`jaffle_shop`.`dbt_columns`\n)\n\nselect\n    database_name,\n    schema_name,\n    table_name,\n    name,\n    data_type,\n    description\nfrom information_schema_columns\nleft join dbt_columns using (database_name, schema_name, table_name, name)", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`enriched_columns`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:09.474297Z", "completed_at": "2024-12-16T07:45:09.484591Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:09.486090Z", "completed_at": "2024-12-16T07:45:14.625304Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 5.152519941329956, "adapter_response": {"_message": "MERGE (0.0 rows, 0 processed)", "code": "MERGE", "rows_affected": 0, "bytes_processed": 0, "bytes_billed": 0, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "89db6976-96cb-46f9-b404-bf5b03b3ea43", "slot_ms": 5394}, "message": "MERGE (0.0 rows, 0 processed)", "failures": null, "unique_id": "model.elementary.test_result_rows", "compiled": true, "compiled_code": "\n\n-- depends_on: `ubie-yu-sandbox`.`jaffle_shop`.`elementary_test_results`\nselect * from (\n            select\n            \n                \n        cast('this_is_just_a_long_dummy_string' as string) as elementary_test_results_id\n\n,\n                \n        cast('this_is_just_a_long_dummy_string' as string) as result_row\n\n,\n                cast('2091-02-17' as timestamp) as detected_at\n\n,\n                cast('2091-02-17' as timestamp) as created_at\n\n\n        ) as empty_table\n        where 1 = 0", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`test_result_rows`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:13.831666Z", "completed_at": "2024-12-16T07:45:13.835555Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:13.837009Z", "completed_at": "2024-12-16T07:45:16.194618Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 2.371799945831299, "adapter_response": {"_message": "CREATE TABLE (100.0 rows, 6.0 KiB processed)", "code": "CREATE TABLE", "rows_affected": 100, "bytes_processed": 6170, "bytes_billed": 31457280, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "b5d6a9a9-1eec-4a68-bc93-0eb603c28965", "slot_ms": 11736}, "message": "CREATE TABLE (100.0 rows, 6.0 KiB processed)", "failures": null, "unique_id": "model.jaffle_shop.customers", "compiled": true, "compiled_code": "\n\n\nwith customers as (\n\n    select * from `ubie-yu-sandbox`.`jaffle_shop`.`stg_customers`\n\n),\n\norders as (\n\n    select * from `ubie-yu-sandbox`.`jaffle_shop`.`stg_orders`\n\n),\n\npayments as (\n\n    select * from `ubie-yu-sandbox`.`jaffle_shop`.`stg_payments`\n\n),\n\ncustomer_orders as (\n\n        select\n        customer_id,\n\n        min(order_date) as first_order,\n        max(order_date) as most_recent_order,\n        count(order_id) as number_of_orders\n    from orders\n\n    group by customer_id\n\n),\n\ncustomer_payments as (\n\n    select\n        orders.customer_id,\n        sum(amount) as total_amount\n\n    from payments\n\n    left join orders on\n         payments.order_id = orders.order_id\n\n    group by orders.customer_id\n\n),\n\nfinal as (\n\n    select\n        customers.customer_id,\n        customers.first_name,\n        customers.last_name,\n        customer_orders.first_order,\n        customer_orders.most_recent_order,\n        customer_orders.number_of_orders,\n        customer_payments.total_amount as customer_lifetime_value\n\n    from customers\n\n    left join customer_orders\n        on customers.customer_id = customer_orders.customer_id\n\n    left join customer_payments\n        on  customers.customer_id = customer_payments.customer_id\n\n)\n\nselect * from final", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`customers`", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:16.199250Z", "completed_at": "2024-12-16T07:45:16.208431Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:16.210491Z", "completed_at": "2024-12-16T07:45:16.942915Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7453556060791016, "adapter_response": {"_message": "SELECT (1.0 rows, 800.0 Bytes processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 800, "bytes_billed": 10485760, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "6af5d1d1-3648-46c6-9051-0952f38e7007", "slot_ms": 27}, "message": null, "failures": 0, "unique_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom `ubie-yu-sandbox`.`jaffle_shop`.`customers`\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:16.203473Z", "completed_at": "2024-12-16T07:45:16.209803Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:16.213216Z", "completed_at": "2024-12-16T07:45:16.987892Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.7899320125579834, "adapter_response": {"_message": "SELECT (1.0 rows, 800.0 Bytes processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 800, "bytes_billed": 10485760, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "49511220-107b-4da0-9f95-d569a49ee144", "slot_ms": 57}, "message": null, "failures": 0, "unique_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select customer_id as unique_field\n  from `ubie-yu-sandbox`.`jaffle_shop`.`customers`\n  where customer_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:13.861191Z", "completed_at": "2024-12-16T07:45:13.876616Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:13.878002Z", "completed_at": "2024-12-16T07:45:17.379968Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.5217950344085693, "adapter_response": {"_message": "CREATE TABLE (99.0 rows, 6.5 KiB processed)", "code": "CREATE TABLE", "rows_affected": 99, "bytes_processed": 6660, "bytes_billed": 20971520, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "bbe4988f-d038-40cf-b451-0fa778f182a5", "slot_ms": 4933}, "message": "CREATE TABLE (99.0 rows, 6.5 KiB processed)", "failures": null, "unique_id": "model.jaffle_shop.orders", "compiled": true, "compiled_code": "\n\n\n\nwith orders as (\n\n    select * from `ubie-yu-sandbox`.`jaffle_shop`.`stg_orders`\n\n),\n\npayments as (\n\n    select * from `ubie-yu-sandbox`.`jaffle_shop`.`stg_payments`\n\n),\n\norder_payments as (\n\n    select\n        order_id,\n\n        sum(case when payment_method = 'credit_card' then amount else 0 end) as credit_card_amount,\n        sum(case when payment_method = 'coupon' then amount else 0 end) as coupon_amount,\n        sum(case when payment_method = 'bank_transfer' then amount else 0 end) as bank_transfer_amount,\n        sum(case when payment_method = 'gift_card' then amount else 0 end) as gift_card_amount,\n        sum(amount) as total_amount\n\n    from payments\n\n    group by order_id\n\n),\n\nfinal as (\n\n    select\n        orders.order_id,\n        orders.customer_id,\n        orders.order_date,\n        orders.status,\n\n        order_payments.credit_card_amount,\n\n        order_payments.coupon_amount,\n\n        order_payments.bank_transfer_amount,\n\n        order_payments.gift_card_amount,\n\n        order_payments.total_amount as amount\n\n    from orders\n\n\n    left join order_payments\n        on orders.order_id = order_payments.order_id\n\n)\n\nselect * from final", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`orders`", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:17.415394Z", "completed_at": "2024-12-16T07:45:17.442232Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:17.454062Z", "completed_at": "2024-12-16T07:45:18.153072Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.7594480514526367, "adapter_response": {"_message": "SELECT (1.0 rows, 792.0 Bytes processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 792, "bytes_billed": 10485760, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "0bf0f702-7f68-46a6-b625-738a7d7eef05", "slot_ms": 26}, "message": null, "failures": 0, "unique_id": "test.jaffle_shop.not_null_orders_customer_id.c5f02694af", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom `ubie-yu-sandbox`.`jaffle_shop`.`orders`\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:17.404613Z", "completed_at": "2024-12-16T07:45:17.438678Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:17.446454Z", "completed_at": "2024-12-16T07:45:18.173688Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.7843072414398193, "adapter_response": {"_message": "SELECT (1.0 rows, 792.0 Bytes processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 792, "bytes_billed": 10485760, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "73bcb97e-2ce7-4f4d-abce-0828e5b498ab", "slot_ms": 33}, "message": null, "failures": 0, "unique_id": "test.jaffle_shop.not_null_orders_bank_transfer_amount.7743500c49", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect bank_transfer_amount\nfrom `ubie-yu-sandbox`.`jaffle_shop`.`orders`\nwhere bank_transfer_amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:17.408854Z", "completed_at": "2024-12-16T07:45:17.439224Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:17.449288Z", "completed_at": "2024-12-16T07:45:18.180577Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.7882649898529053, "adapter_response": {"_message": "SELECT (1.0 rows, 792.0 Bytes processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 792, "bytes_billed": 10485760, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "b9793635-de71-4375-9562-98aa749562d6", "slot_ms": 30}, "message": null, "failures": 0, "unique_id": "test.jaffle_shop.not_null_orders_coupon_amount.ab90c90625", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect coupon_amount\nfrom `ubie-yu-sandbox`.`jaffle_shop`.`orders`\nwhere coupon_amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:17.419456Z", "completed_at": "2024-12-16T07:45:17.442722Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:17.457243Z", "completed_at": "2024-12-16T07:45:18.196283Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.8023898601531982, "adapter_response": {"_message": "SELECT (1.0 rows, 792.0 Bytes processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 792, "bytes_billed": 10485760, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "8521429e-2201-4b48-9327-b3cceec00bed", "slot_ms": 45}, "message": null, "failures": 0, "unique_id": "test.jaffle_shop.not_null_orders_gift_card_amount.413a0d2d7a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect gift_card_amount\nfrom `ubie-yu-sandbox`.`jaffle_shop`.`orders`\nwhere gift_card_amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:17.400917Z", "completed_at": "2024-12-16T07:45:17.435296Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:17.443242Z", "completed_at": "2024-12-16T07:45:18.205089Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.8170950412750244, "adapter_response": {"_message": "SELECT (1.0 rows, 792.0 Bytes processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 792, "bytes_billed": 10485760, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "d1a189ff-1c99-4537-9553-66968c89ed1f", "slot_ms": 32}, "message": null, "failures": 0, "unique_id": "test.jaffle_shop.not_null_orders_amount.106140f9fd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect amount\nfrom `ubie-yu-sandbox`.`jaffle_shop`.`orders`\nwhere amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:17.427653Z", "completed_at": "2024-12-16T07:45:17.445748Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:17.459397Z", "completed_at": "2024-12-16T07:45:18.221839Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8275127410888672, "adapter_response": {"_message": "SELECT (1.0 rows, 792.0 Bytes processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 792, "bytes_billed": 10485760, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "70a6f7e1-0c72-4a94-b712-c0d98831b3b7", "slot_ms": 31}, "message": null, "failures": 0, "unique_id": "test.jaffle_shop.not_null_orders_order_id.cf6c17daed", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect order_id\nfrom `ubie-yu-sandbox`.`jaffle_shop`.`orders`\nwhere order_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:17.412003Z", "completed_at": "2024-12-16T07:45:17.441796Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:17.451815Z", "completed_at": "2024-12-16T07:45:18.222969Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.8296201229095459, "adapter_response": {"_message": "SELECT (1.0 rows, 792.0 Bytes processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 792, "bytes_billed": 10485760, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "043ed47c-683c-48c2-b2b5-9529c4fa18a8", "slot_ms": 18}, "message": null, "failures": 0, "unique_id": "test.jaffle_shop.not_null_orders_credit_card_amount.d3ca593b59", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect credit_card_amount\nfrom `ubie-yu-sandbox`.`jaffle_shop`.`orders`\nwhere credit_card_amount is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:17.396031Z", "completed_at": "2024-12-16T07:45:17.422721Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:17.439652Z", "completed_at": "2024-12-16T07:45:18.247045Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.8608288764953613, "adapter_response": {"_message": "SELECT (1.0 rows, 1.0 KiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 1030, "bytes_billed": 10485760, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "2cdc3a84-0b6e-4489-8c23-b492f8bd365f", "slot_ms": 58}, "message": null, "failures": 0, "unique_id": "test.jaffle_shop.accepted_values_orders_status__placed__shipped__completed__return_pending__returned.be6b5b5ec3", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from `ubie-yu-sandbox`.`jaffle_shop`.`orders`\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'placed','shipped','completed','return_pending','returned'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:17.435665Z", "completed_at": "2024-12-16T07:45:17.451343Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:17.464483Z", "completed_at": "2024-12-16T07:45:18.590320Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.1950368881225586, "adapter_response": {"_message": "SELECT (1.0 rows, 792.0 Bytes processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 792, "bytes_billed": 10485760, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "43dc428c-0796-4da9-9880-7290f7d73ef8", "slot_ms": 59}, "message": null, "failures": 0, "unique_id": "test.jaffle_shop.unique_orders_order_id.fed79b3a6e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select order_id as unique_field\n  from `ubie-yu-sandbox`.`jaffle_shop`.`orders`\n  where order_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:17.430817Z", "completed_at": "2024-12-16T07:45:17.446089Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:17.461421Z", "completed_at": "2024-12-16T07:45:18.651055Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 1.2563238143920898, "adapter_response": {"_message": "SELECT (1.0 rows, 1.6 KiB processed)", "code": "SELECT", "rows_affected": 1, "bytes_processed": 1592, "bytes_billed": 20971520, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "d9be95a3-c7e9-49b7-ae88-c6b4aeb72c31", "slot_ms": 75}, "message": null, "failures": 0, "unique_id": "test.jaffle_shop.relationships_orders_customer_id__customer_id__ref_customers_.c6ec7f58f2", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from `ubie-yu-sandbox`.`jaffle_shop`.`orders`\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from `ubie-yu-sandbox`.`jaffle_shop`.`customers`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:18.593466Z", "completed_at": "2024-12-16T07:45:18.597907Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:18.598350Z", "completed_at": "2024-12-16T07:45:24.608181Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 6.015548944473267, "adapter_response": {"_message": "SCRIPT (2.4 KiB processed)", "code": "SCRIPT", "bytes_processed": 2414, "bytes_billed": 52428800, "location": "asia-northeast1", "project_id": "ubie-yu-sandbox", "job_id": "89ff6a34-45d8-4e87-92d1-4a21ae57e4f4", "slot_ms": 2899}, "message": "SCRIPT (2.4 KiB processed)", "failures": null, "unique_id": "model.jaffle_shop.daily_orders", "compiled": true, "compiled_code": "\n\nWITH monthly_orders AS (\n  SELECT\n    -- convert date to first day of month\n    order_date,\n    status,\n    (\n      SELECT SUM(amount)\n      FROM UNNEST([1, 2, 3, 4, 5]) AS amount\n      WHERE amount > 2\n    ) AS demo,\n    SUM(amount + 1) AS total_amount,\n  FROM `ubie-yu-sandbox`.`jaffle_shop`.`orders`\n  GROUP BY 1, 2\n)\n\nSELECT\n  DATE(order_date) AS order_date,\n  COUNT(*) AS total_orders,\nFROM monthly_orders\n\nWHERE\n  order_date >= (SELECT MAX(order_date) FROM `ubie-yu-sandbox`.`jaffle_shop`.`daily_orders`)\n\nGROUP BY 1", "relation_name": "`ubie-yu-sandbox`.`jaffle_shop`.`daily_orders`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-16T07:45:24.610912Z", "completed_at": "2024-12-16T07:45:32.502145Z"}, {"name": "execute", "started_at": "2024-12-16T07:45:32.502565Z", "completed_at": "2024-12-16T07:45:32.502568Z"}], "thread_id": "main", "execution_time": 7.891656, "adapter_response": {}, "message": "elementary.on-run-end.0 passed", "failures": 0, "unique_id": "operation.elementary.elementary-on-run-end-0", "compiled": true, "compiled_code": "\n      \n      \n\n      \n        \n      \n\n      \n        \n      \n\n      \n        \n      \n\n      \n        \n      \n\n      \n        \n      \n  \n", "relation_name": null, "batch_results": null}], "elapsed_time": 38.73419785499573, "args": {"log_path": "/Users/yu/local/src/github/jaffle_shop/logs", "log_level_file": "debug", "write_json": true, "print": true, "log_format_file": "debug", "resource_types": [], "cache_selected_only": false, "state_modified_compare_vars": false, "strict_mode": false, "require_resource_names_without_spaces": false, "partial_parse": true, "indirect_selection": "eager", "which": "build", "require_batched_execution_for_custom_microbatch_strategy": false, "source_freshness_run_project_hooks": false, "state_modified_compare_more_unrendered_values": false, "favor_state": false, "profiles_dir": "/Users/yu/local/src/github/jaffle_shop", "introspect": true, "select": [], "version_check": true, "static_parser": true, "require_explicit_package_overrides_for_builtin_materializations": true, "defer": false, "exclude": [], "include_saved_query": false, "log_format": "default", "invocation_command": "dbt build", "partial_parse_file_diff": true, "log_file_max_bytes": 10485760, "empty": false, "send_anonymous_usage_stats": true, "exclude_resource_types": [], "show_resource_report": false, "project_dir": "/Users/yu/local/src/github/jaffle_shop", "use_colors_file": true, "vars": {}, "quiet": false, "macro_debugging": false, "use_colors": true, "warn_error_options": {"include": [], "exclude": []}, "skip_nodes_if_on_run_start_fails": false, "populate_cache": true, "export_saved_queries": false, "printer_width": 80, "show": false, "log_level": "info", "require_nested_cumulative_type_params": false, "require_yaml_configuration_for_mf_time_spines": false}}
